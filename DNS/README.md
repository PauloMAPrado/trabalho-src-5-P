### 🖧 DNS com Docker e Debian

### 👨‍💻 Parte 1: Servidor

# Criar contêiner Debian para o servidor DNS
```bash
docker run -it --name debian-rede-dns debian bash
```

# Atualizar pacotes
```bash
apt update -y
```

# Instalar o Bind9 (servidor DNS) e utilitários de DNS
```bash
apt install -y bind9 dnsutils
```

# Instalar o Bind9 novamente (se necessário)
```bash
apt install bind9
```

# Instalar o nano (editor de texto)
```bash
apt install nano
```

# Editar o arquivo de configuração do Bind9
```bash
nano /etc/bind/named.conf.local
```

# Editar o arquivo de zona para a empresa
```bash
nano /etc/bind/db.empresa.local
```

# Editar o arquivo de zona para o IP
```bash
nano /etc/bind/db.192
```

# Testar a configuração do DNS
```bash
dig @127.0.0.1 www.empresa.local
```

# Editar o arquivo de opções de configuração do Bind9
```bash
nano /etc/named.conf.options
```

# Reiniciar o serviço Bind9
```bash
service bind9 restart
```

# Sair do contêiner
```bash
exit
```

### 💻 Parte 2: Cliente

# Criar contêiner Debian para o cliente DNS
```bash
docker run -it --name debian-rede-dns-cliente debian bash
```

# Atualizar pacotes
```bash
apt update -y
```

# Instalar o nano (editor de texto)
```bash
apt install nano
```

# Editar o arquivo de configurações de DNS
```bash
nano /etc/resolv.conf
```

# Instalar utilitário para testar a conectividade (ping)
```bash
apt install iputils-ping
```

# Testar a resolução de DNS
```bash
ping www.empresa.local
```

# Instalar o utilitário DNS
```bash
apt install dnsutils
```

# Testar o DNS com o comando dig
```bash
dig www.empresa.local @172.17.0.2
```

# Sair do contêiner
```bash
exit
```

# Documento /etc/bind/named.conf.local
```bash                 
zone "empresa.local" {
    type master;
    file "/etc/bind/db.empresa.local";
};

zone "1.168.192.in-addr.arpa" {
    type master;
    file "/etc/bind/db.192";
};
```

# Documento /etc/bind/db.empresa.local

```bash
$TTL    604800
@       IN      SOA     ns1.empresa.local. root.empresa.local. (
                        2         ; Serial
                        604800    ; Refresh
                        86400     ; Retry
                        2419200   ; Expire
                        604800 )  ; Negative Cache TTL
;
@       IN      NS      ns1.empresa.local.
ns1     IN      A       192.168.1.10
www     IN      A       192.168.1.11
ftp     IN      A       192.168.1.12
dhcp    IN      A       192.168.1.13
samba   IN      A       192.168.1.14
ldap    IN      A       192.168.1.15
```

# Documento /etc/bind/db.192

```bash
$TTL    604800
@       IN      SOA     ns1.empresa.local. root.empresa.local. (
                        2         ; Serial
                        604800    ; Refresh
                        86400     ; Retry
                        2419200   ; Expire
                        604800 )  ; Negative Cache TTL
;
@       IN      NS      ns1.empresa.local.
10      IN      PTR     ns1.empresa.local.
11      IN      PTR     www.empresa.local.
12      IN      PTR     ftp.empresa.local.
13      IN      PTR     dhcp.empresa.local.
14      IN      PTR     samba.empresa.local.
15      IN      PTR     ldap.empresa.local.
```

# Documento /etc/named.conf.options

```bash
options {
    directory "/var/cache/bind";

    // Escutar em todas as interfaces
    listen-on {any;};
    listen-on-v6 {any;};

    // Permitir consultas de qualquer lugar
    allow-query {any;};

    // Encaminhadores (opcional, pode usar DNS p  blicos)
    forwarders {
        8.8.8.8;
        8.8.4.4;
    };

    dnssec-validation auto;

    auth-nxdomain no;
    listen-on {any;};
};
```

# Documento /etc/resolv.conf (Cliente)

```bash
# Generated by Docker Engine.
# This file can be edited; Docker Engine will not make further changes once >
# has been modified.

nameserver 192.168.200.3
nameserver 192.168.200.4
nameserver 8.8.8.8
search .

# Based on host file: '/run/systemd/resolve/resolv.conf' (legacy)
# Overrides: []
```

